# ZoomableG

Компонент рендерит `g`-элемент, отвечающий за управление рабочей областью с помощью мыши и сохраняющий состояние зума.

Используется для создания возможности зумить график.

В качестве потомка принимает функцию, генератор элементов графика. Функция имеет сигнатуру `generateChart({xScale, yScale, mouseHandlerRef})` и должна возвращать react-элементы для отрисовки.

Один из дочерних элементов должен использовать колбек `mouseHandlerRef` в качестве значения свойства `ref`, этот элемент и все его потомки будут реагировать на использование мыши (перетаскивание, использования колесика).

```jsx

function render({ xScale, yScale }) {
  return (
    <ZoomableG xScale={xScale} yScale={yScale}>
      {({ xScale, yScale, mouseHandlerRef }) => {
        const width = xScale.range()[1];
        const height = yScale.range()[0];
        const backStyle = {
          fill: 'none',
          pointerEvents: 'all',
        };

        return (
          <g ref={mouseHandlerRef}>
            <!-- Прямоугольник, «растягивающий» элемент g
            до размеров рабочей области графика -->
            <rect width={width} height={height} style={backStyle} />
            <!-- далее рисуем содержимое графика -->
          </g>
        );
      }}
    </ZoomableG>
  );
}

```


## Свойства

Свойства `xScale` и `yScale` — обязательные, остальные свойства имеют значения по умолчанию.

Свойства `zoomState` и `onZoomStateChange` используются для управления зумом. Они полезны, если окружение графика может менять состояние зума (хоткей `Esc` для сброса в дефолт, кнопки `+`/`-` для изменения масштаба и т.п.) или задаёт состояние зума по умолчанию (отображение сохранённого состояния графика, сохраняющего зум).

Если график должен поддерживать перетаскивание и зум, но не должен поддерживать внешнее управление зумом, использовать свойства `zoomState` и `onZoomStateChange` не потребуется.

### Список свойств

- [шкала](https://github.com/d3/d3-scale#continuous-scales) `xScale` для оси абсцисс;
- [шкала](https://github.com/d3/d3-scale#continuous-scales) `yScale` для оси ординат;
- число `minScaleFactor` для ограничение минимальной глубины зума, по умолчанию — 1, т.е. полотно может быть отдалено только до изначального масштаба;
- число `maxScaleFactor` для ограничение максимальной глубины зума, по умолчанию — 16, т.е. полотно может быть приближено в 16 раз;
- объект `limits` с полями `x` и `y`, в каждом поле — массив из двух чисел, диапазон значений данных в котором будет происходить зум, по умолчанию — `{ x: [-∞, ∞], y: [-∞, ∞] }`;
- объект `zoomState` с полями `scale` (число) и `center` (объект с числовыми полями `x` и `y`), по умолчанию — `{ scale: 1, center: { x: 0.5, y: 0.5 }}`; координаты считаются в процентах от единицы; если свойство используется, его значение должно быть обновлено после вызова компонентом `onZoomStateChange`;
- колбек `onZoomStateChange`, функция с сигнатурой `onZoomStateChange(newZoomState)`, вызывается компонентом при изменении состояния зума по сравнению с переданным в `props`, по умолчанию — NOP.

Шкалы могут быть созданы с помощью `d3` версий 3 и 4.
